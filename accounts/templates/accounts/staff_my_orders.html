<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Мои заказы</title>
  <style>
    body { font-family: Arial, sans-serif; background:#faf5f8; margin:0; padding:20px; }
    .order { background:white; padding:12px 16px; margin-bottom:12px;
             border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.06); max-width:700px; }
    ul { margin:4px 0 0 16px; }
    select { padding:4px 8px; }
    .btn { padding:4px 10px; background:#c2185b; color:white; border-radius:4px; border:none; }
  </style>
</head>
<body>

<p><a href="{% url 'menu' %}">← Меню</a></p>

<h1>Мои заказы</h1>

{% if orders_data %}
  {% for od in orders_data %}
    <div class="order">
      <h3>Заказ №{{ od.order.id_order }} от {{ od.order.order_date }}</h3>
      <p>Сумма: {{ od.order.total_amount }} ₽</p>
      <p>Текущий статус: {{ od.order.status_order }}</p>

      <p>Состав:</p>
      <ul>
        {% for item in od.items %}
          <li>{{ item }}</li>
        {% endfor %}
      </ul>

      <form method="post" action="{% url 'staff_update_order_status' od.order.id_order %}">
        {% csrf_token %}
        <label>Изменить статус:
          <select name="status_order">
            {% for st in statuses %}
              <option value="{{ st }}" {% if st == od.order.status_order %}selected{% endif %}>
                {{ st }}
              </option>
            {% endfor %}
          </select>
        </label>
        <button class="btn" type="submit">Сохранить</button>
      </form>
    </div>
  {% endfor %}
{% else %}
  <p>У вас пока нет заказов.</p>
{% endif %}

</body>
</html>
